# RGB意識調査 統合レポート生成システム

## 概要
本システムは、RGB意識調査のExcelアンケート結果を処理し、様々な視点から分析された整形済みExcelレポート群を自動生成するためのStreamlitウェブアプリケーションです。
生のアンケートデータ（Excelファイル）をアップロードし、調査時期を選択するだけで、会議資料や学年別の詳細分析レポート、グラフを含むExcelファイル一式を簡単に取得できます。

## 主な機能
-   **Webベースの直感的なインターフェース:** ファイルのアップロードや操作をブラウザ上で行えます。
-   **単一クリックでのレポート一括生成:** 複数の複雑なExcelレポートを、一度の操作で全て生成します。
-   **動的な調査時期対応:** 4月(第一回)、9月(第二回)、1月(第三回)など、異なる調査時期のデータを柔軟に処理し、出力ファイル名やレポート内容に反映します。
-   **学年別詳細レポート:** 各学年（1年、2年、3年、全体）ごとの集計結果と詳細な回答分布を含むレポートを生成します。
-   **多角的な分析グラフ:**
    -   **レーダーチャート:** 全体、学年別、および全学年比較用のレーダーチャートを生成し、コンピテンシーバランスを視覚的に表示します。
    -   **推移グラフ:** 過去のデータ（R3〜R7）との比較折れ線グラフを生成し、経年での傾向変化を把握できます。
-   **堅牢なデータ処理:** 入力ファイルに学年を特定するID列がない場合でも、エラーで停止することなく、可能な限りのレポート（全体レポートなど）を生成します。

## 動作環境 / 要件
-   Python 3.x
-   以下のPythonライブラリ:
    -   `streamlit`
    -   `pandas`
    -   `plotly`
    -   `openpyxl`
    -   `xlsxwriter`

## セットアップと実行方法

1.  **リポジトリのクローン (またはファイルの配置):**
    本リポジトリのファイルをローカル環境に配置します。

2.  **必要なライブラリのインストール:**
    ターミナルでプロジェクトのルートディレクトリに移動し、以下のコマンドを実行して必要なライブラリをインストールします。
    ```bash
    pip install -r requirements.txt
    ```

3.  **アプリケーションの起動:**
    以下のコマンドを実行してStreamlitアプリケーションを起動します。
    ```bash
    streamlit run streamlit_app.py
    ```
    コマンド実行後、ターミナルに表示されるローカルURL（例: `http://localhost:8501`）をブラウザで開きます。

## 使用方法

1.  **Excelファイルのアップロード:**
    サイドバーの「① アンケート結果Excelをアップロード」セクションから、処理したいアンケート結果のExcelファイル（.xlsx形式）をアップロードします。

2.  **調査時期の選択:**
    サイドバーの「② 調査時期を選択」ドロップダウンから、アップロードしたファイルが対応する調査時期（例: 「1月(第三回)」）を正確に選択します。

3.  **レポートの一括生成:**
    メイン画面に表示される「全レポートを一括生成」ボタンをクリックします。
    処理が完了すると、生成された各レポートのダウンロードボタンが表示されます。

4.  **レポートのダウンロード:**
    表示されたダウンロードボタンをクリックして、必要なExcelレポートをダウンロードします。

## 入力データ形式

-   ファイル形式は`.xlsx`である必要があります。
-   アンケートの質問項目は、システムに組み込まれた`COMPETENCY_MAP`と正確に一致している必要があります。
-   **学年別の分析を行う場合:**
    -   `"あなたのクラスと出席番号を4桁の数字で入力してください　例）1年6組34番 ⇒ 1634"` という名前の列が必須です。
    -   この列の4桁の数字の**最初の1桁**が学年（例: `1`年、`2`年、`3`年）を、**2桁目**がクラス（例: `6`組）を示している必要があります。

## 出力ファイル

「全レポートを一括生成」ボタンをクリックすると、以下のExcelファイル群が生成・ダウンロード可能になります。

-   **会議資料用レポート:**
    -   `【その１データ】 RGB意識調査の質問項目と表(職員会議用）.xlsx`: 質問項目ごとの平均値と各調査時期の比較表。
    -   `【その２データ】RGBレーダーチャート（R7職員会議資料用）.xlsx`: コンピテンシーバランスのレーダーチャート（全体、学年別、学年比較）。
    -   `【その３データ】【R3～R7】RGB推移グラフ（R7職員会議用）.xlsx`: コンピテンシー平均値の経年推移グラフ。
-   **学年別詳細レポート:**
    -   `1.RGB意識調査R7.[選択した月]結果（1年・分布あり）.xlsx`
    -   `1.RGB意識調査R7.[選択した月]結果（2年・分布あり）.xlsx`
    -   `1.RGB意識調査R7.[選択した月]結果（3年・分布あり）.xlsx`
    -   `1.RGB意識調査R7.[選択した月]結果（全体・分布あり）.xlsx`

---
